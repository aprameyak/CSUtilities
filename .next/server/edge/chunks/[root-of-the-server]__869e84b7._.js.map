{"version":3,"sources":["turbopack:///[project]/node_modules/next/dist/src/server/web/globals.ts","turbopack:///[project]/edge-wrapper.js"],"sourcesContent":["import type {\n  InstrumentationModule,\n  InstrumentationOnRequestError,\n} from '../instrumentation/types'\n\ndeclare const _ENTRIES: any\n\nexport async function getEdgeInstrumentationModule(): Promise<\n  InstrumentationModule | undefined\n> {\n  const instrumentation =\n    '_ENTRIES' in globalThis &&\n    _ENTRIES.middleware_instrumentation &&\n    (await _ENTRIES.middleware_instrumentation)\n\n  return instrumentation\n}\n\nlet instrumentationModulePromise: Promise<any> | null = null\nasync function registerInstrumentation() {\n  // Ensure registerInstrumentation is not called in production build\n  if (process.env.NEXT_PHASE === 'phase-production-build') return\n  if (!instrumentationModulePromise) {\n    instrumentationModulePromise = getEdgeInstrumentationModule()\n  }\n  const instrumentation = await instrumentationModulePromise\n  if (instrumentation?.register) {\n    try {\n      await instrumentation.register()\n    } catch (err: any) {\n      err.message = `An error occurred while loading instrumentation hook: ${err.message}`\n      throw err\n    }\n  }\n}\n\nexport async function edgeInstrumentationOnRequestError(\n  ...args: Parameters<InstrumentationOnRequestError>\n) {\n  const instrumentation = await getEdgeInstrumentationModule()\n  try {\n    await instrumentation?.onRequestError?.(...args)\n  } catch (err) {\n    // Log the soft error and continue, since the original error has already been thrown\n    console.error('Error in instrumentation.onRequestError:', err)\n  }\n}\n\nlet registerInstrumentationPromise: Promise<void> | null = null\nexport function ensureInstrumentationRegistered() {\n  if (!registerInstrumentationPromise) {\n    registerInstrumentationPromise = registerInstrumentation()\n  }\n  return registerInstrumentationPromise\n}\n\nfunction getUnsupportedModuleErrorMessage(module: string) {\n  // warning: if you change these messages, you must adjust how dev-overlay's middleware detects modules not found\n  return `The edge runtime does not support Node.js '${module}' module.\nLearn More: https://nextjs.org/docs/messages/node-module-in-edge-runtime`\n}\n\nfunction __import_unsupported(moduleName: string) {\n  const proxy: any = new Proxy(function () {}, {\n    get(_obj, prop) {\n      if (prop === 'then') {\n        return {}\n      }\n      throw new Error(getUnsupportedModuleErrorMessage(moduleName))\n    },\n    construct() {\n      throw new Error(getUnsupportedModuleErrorMessage(moduleName))\n    },\n    apply(_target, _this, args) {\n      if (typeof args[0] === 'function') {\n        return args[0](proxy)\n      }\n      throw new Error(getUnsupportedModuleErrorMessage(moduleName))\n    },\n  })\n  return new Proxy({}, { get: () => proxy })\n}\n\nfunction enhanceGlobals() {\n  if (process.env.NEXT_RUNTIME !== 'edge') {\n    return\n  }\n\n  // The condition is true when the \"process\" module is provided\n  if (process !== global.process) {\n    // prefer local process but global.process has correct \"env\"\n    process.env = global.process.env\n    global.process = process\n  }\n\n  // to allow building code that import but does not use node.js modules,\n  // webpack will expect this function to exist in global scope\n  try {\n    Object.defineProperty(globalThis, '__import_unsupported', {\n      value: __import_unsupported,\n      enumerable: false,\n      configurable: false,\n    })\n  } catch {}\n\n  // Eagerly fire instrumentation hook to make the startup faster.\n  void ensureInstrumentationRegistered()\n}\n\nenhanceGlobals()\n","self._ENTRIES ||= {};\nconst modProm = import('MODULE');\nmodProm.catch(() => {});\nself._ENTRIES[\"middleware_app/opengraph-image/route\"] = new Proxy(modProm, {\n    get(modProm, name) {\n        if (name === \"then\") {\n            return (res, rej) => modProm.then(res, rej);\n        }\n        let result = (...args) => modProm.then((mod) => (0, mod[name])(...args));\n        result.then = (res, rej) => modProm.then((mod) => mod[name]).then(res, rej);\n        return result;\n    },\n});\n"],"names":["getEdgeInstrumentationModule","instrumentation","globalThis","_ENTRIES","middleware_instrumentation","instrumentationModulePromise","registerInstrumentation","process","env","NEXT_PHASE","register","err","message","edgeInstrumentationOnRequestError","args","onRequestError","console","error","registerInstrumentationPromise","ensureInstrumentationRegistered","getUnsupportedModuleErrorMessage","module","__import_unsupported","moduleName","proxy","Proxy","get","_obj","prop","Error","construct","apply","_target","_this","enhanceGlobals","NEXT_RUNTIME","global","Object","defineProperty","value","enumerable","configurable"],"mappings":"qMAOO,eAAeA,IAQpB,MAJE,CAIKC,YAJSC,YACdC,SAASC,0BAA0B,EAClC,MAAMD,SAASC,0BAA0B,AAG9C,CAEA,IAAIC,EAAoD,KACxD,eAAeC,IAEb,GAA+B,2BAA3BC,QAAQC,GAAG,CAACC,UAAU,CAA+B,MACrD,CAACJ,GACHA,GAA+BL,GAAAA,EAEjC,IAAMC,EAAkB,MAAMI,EAC9B,GAAIJ,EAJ+B,IAI/BA,EAAAA,KAAAA,EAAAA,EAAiBS,QAAQ,CAC3B,CAD6B,EACzB,CACF,MAAMT,EAAgBS,QAAQ,EAChC,CAAE,MAAOC,EAAU,CAEjB,MADAA,EAAIC,OAAO,CAAG,CAAC,sDAAsD,EAAED,EAAIC,OAAO,CAAA,CAAE,CAC9ED,CACR,CAEJ,CAEO,eAAeE,EACpB,GAAGC,CAA+C,EAElD,IAAMb,EAAkB,MAAMD,IAC9B,GAAI,KACIC,CAAN,MAAA,EAAMA,MAAAA,CAAAA,EAAAA,AAA+B,GAA/BA,GAAAA,GAAAA,EAAiBc,cAAAA,AAAc,EAAA,KAAA,EAA/Bd,EAAAA,IAAAA,CAAAA,KAAqCa,GAC7C,CAAE,CAD2CA,KACpCH,EAAK,CAEZK,QAAQC,KAAK,CAAC,2CAA4CN,EAC5D,CACF,CAEA,IAAIO,EAAuD,KACpD,SAASC,IAId,OAHI,AAACD,IACHA,EAAiCZ,GAAAA,EAE5BY,CACT,CAEA,SAASE,EAAiCC,CAAc,EAEtD,KARqC,CAQ9B,CAAC,2CAA2C,EAAEA,EAAO;wEACU,CAAC,AACzE,CA6BMd,UAAY6B,EAAAA,CAAAA,CAAO7B,OAAO,EAAE,CAE9BA,QAAQC,GAAG,CAAG4B,EAAAA,CAAAA,CAAO7B,OAAO,CAACC,GAAG,CAChC4B,EAAAA,CAAAA,CAAO7B,OAAO,CAAGA,SAKnB,GAAI,CACF8B,OAAOC,cAAc,CAACpC,WAAY,uBAAwB,CACxDqC,MArCN,CAqCajB,QArCJA,AAAqBC,CAAkB,EAC9C,IAAMC,EAAa,IAAIC,MAAM,WAAa,EAAG,CAC3CC,IAAIC,CAAI,CAAEC,CAAI,EACZ,GAAa,QAAQ,CAAjBA,EACF,MAAO,CAAC,CAEV,OAAM,OAAA,cAAuD,CAAvD,AAAIC,MAAMT,EAAiCG,IAA3C,oBAAA,OAAA,mBAAA,gBAAA,CAAsD,EAC9D,EACAO,YACE,MAAM,OAAA,cAAuD,CAAvD,AAAID,MAAMT,EAAiCG,IAA3C,oBAAA,OAAA,mBAAA,gBAAA,CAAsD,EAC9D,EACAQ,MAAMC,CAAO,CAAEC,CAAK,CAAEnB,CAAI,EACxB,GAAuB,YAAnB,AAA+B,OAAxBA,CAAI,CAAC,EAAE,CAChB,OAAOA,CAAI,CAAC,EAAE,CAACU,EAEjB,OAAM,OAAA,cAAuD,CAAvD,AAAIK,MAAMT,EAAiCG,IAA3C,oBAAA,OAAA,mBAAA,gBAAA,CAAsD,EAC9D,CACF,GACA,OAAO,IAAIE,MAAM,CAAC,EAAG,CAAEC,IAAK,IAAMF,CAAM,EAC1C,EAmBMgB,YAAY,EACZC,cAAc,CAChB,EACF,CAAE,KAAM,CAAC,CAGJtB,0JC1GP,KAAK,QAAQ,GAAK,CAAC,EACnB,IAAM,EAAA,QAAA,OAAA,GAAA,IAAA,CAAA,IAAA,EAAA,CAAA,CAAA,QACN,EAAQ,KAAK,CAAC,KAAO,GACrB,KAAK,QAAQ,CAAC,uCAAuC,CAAG,IAAI,MAAM,EAAS,CACvE,IAAI,CAAO,CAAE,CAAI,EACb,GAAa,QAAQ,CAAjB,EACA,MAAO,CAAC,EAAK,IAAQ,EAAQ,IAAI,CAAC,EAAK,GAE3C,IAAI,EAAS,CAAC,GAAG,IAAS,EAAQ,IAAI,CAAE,AAAD,GAAS,CAAC,EAAG,CAAG,CAAC,EAAA,AAAK,KAAK,IAElE,OADA,EAAO,IAAI,CAAG,CAAC,EAAK,IAAQ,EAAQ,IAAI,CAAC,AAAC,GAAQ,CAAG,CAAC,EAAK,EAAE,IAAI,CAAC,EAAK,GAChE,CACX,CACJ","ignoreList":[0]}